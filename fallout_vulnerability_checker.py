# Check for the "Fallout" vulnerability. (Add this fallout part after, if its not working, just rewrite it)
  # Find all functions marked as external or public
  pattern = r"(function.*(external|public).*\()"
  external_functions = re.findall(pattern, contract_code)
  print(f"Found {len(external_functions)} external or public functions:")
  print(external_functions)
  
  # Check each external or public function for calls to other external or public functions
  for function in external_functions:
    pattern = r"\b[^.]+\b(?=\()"  # Find function calls
    function_calls = re.findall(pattern, function)
    if function_calls:
      print(f"Function '{function}' contains the following function calls:")
      print(function_calls)
      
      # Check if the called functions have input validation
      for call in function_calls:
        if call not in external_functions:
          print("Vulnerability found: fallout")
        else:
          print("No fallout vulnerability found.")
